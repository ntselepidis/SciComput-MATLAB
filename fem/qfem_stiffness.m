function [W, M, f] = qfem_stiffness(x1, y1, x2, y2, x3, y3, x4, y4)
    y41 = y4 - y1;
    y12 = y1 - y2;
    x14 = x1 - x4;
    x21 = x2 - x1;

    J = 0.25*((x2 - x1)*(y4 - y1) - (x4 - x1)*(y2 - y1));

    W = zeros(4,4);
    W(1,1) = (2*x14^2 + 3*x14*x21 + 2*x21^2 + 2*y12^2 + 3*y12*y41 + 2*y41^2)/(24*J);
    W(2,2) = (2*x14^2 - 3*x14*x21 + 2*x21^2 + 2*y12^2 - 3*y12*y41 + 2*y41^2)/(24*J);
    W(3,3) = (2*x14^2 + 3*x14*x21 + 2*x21^2 + 2*y12^2 + 3*y12*y41 + 2*y41^2)/(24*J);
    W(4,4) = (2*x14^2 - 3*x14*x21 + 2*x21^2 + 2*y12^2 - 3*y12*y41 + 2*y41^2)/(24*J);
    W(1,2) = -(2*x14^2 - x21^2 - y12^2 + 2*y41^2)/(24*J);
    W(1,3) = -(x14^2 + 3*x14*x21 + x21^2 + y12^2 + 3*y12*y41 + y41^2)/(24*J);
    W(1,4) = (x14^2 - 2*x21^2 - 2*y12^2 + y41^2)/(24*J);
    W(2,3) = (x14^2 - 2*x21^2 - 2*y12^2 + y41^2)/(24*J);
    W(2,4) = -(x14^2 - 3*x14*x21 + x21^2 + y12^2 - 3*y12*y41 + y41^2)/(24*J);
    W(3,4) = -(2*x14^2 - x21^2 - y12^2 + 2*y41^2)/(24*J);
    W(2,1) = W(1,2); W(3,1) = W(1,3); W(4,1) = W(1,4);
    W(3,2) = W(2,3); W(4,2) = W(2,4);
    W(4,3) = W(3,4);

    M = zeros(4,4);
    M(1,1) = (4*J)/9;
    M(2,2) = (4*J)/9;
    M(3,3) = (4*J)/9;
    M(4,4) = (4*J)/9;
    M(1,2) = (2*J)/9;
    M(1,3) = J/9;
    M(1,4) = (2*J)/9;
    M(2,3) = (2*J)/9;
    M(2,4) = J/9;
    M(3,4) = (2*J)/9;
    M(2,1) = M(1,2); M(3,1) = M(1,3); M(4,1) = M(1,4);
    M(3,2) = M(2,3); M(4,2) = M(2,4);
    M(4,3) = M(3,4);

    f = J*ones(4,1);
end
